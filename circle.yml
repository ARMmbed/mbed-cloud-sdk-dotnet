dependencies:
  pre:
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
    - echo "deb http://download.mono-project.com/repo/ubuntu trusty main" | sudo tee /etc/apt/sources.list.d/mono-official.list
    - sudo apt-get update
    - sudo apt-get install mono-complete
    - sudo apt-get install doxygen
    - chmod +x setNugetCerts.sh
    - chmod +x test.sh
test:
  override:
    - yes "yes" | ./setNugetCerts.sh
    - wget https://dist.nuget.org/win-x86-commandline/v2.8.6/nuget.exe
    - mono --runtime=v4.0 nuget.exe restore mbedCloudSDK/packages.config -PackagesDirectory packages
    - mono --runtime=v4.0 nuget.exe restore TestServer/packages.config -PackagesDirectory packages
    - xbuild
    - ./test.sh
    - echo "finished"
deployment:
  production:
    branch: master
    commands:
      - ./generate-docs.sh
